(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0da3e1"],{"6b87":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-table",e._g(e._b({attrs:{rowKey:e.rowKey,columns:e.columns,dataSource:e.dataSource,expandedRowKeys:e.expandedRowKeys},on:{expand:e.handleExpand,expandedRowsChange:function(t){e.expandedRowKeys=t}},scopedSlots:e._u([e._l(e.slots,(function(t){return{key:t,fn:function(n,r,a){return[e._t(t,null,null,{text:n,record:r,index:a})]}}}))],null,!0)},"a-table",e.tableAttrs,!1),e.$listeners))},a=[],i=n("0fea");function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o={name:"JTreeTable",props:{rowKey:{type:String,default:"id"},queryKey:{type:String,default:"parentId"},queryParams:{type:Object,default:function(){return{}}},topValue:{type:String,default:null},columns:{type:Array,required:!0},url:{type:String,required:!0},childrenUrl:{type:String,default:null},tableProps:{type:Object,default:function(){return{}}},immediateRequest:{type:Boolean,default:!0},condition:{type:String,default:"",required:!1}},data:function(){return{dataSource:[],expandedRowKeys:[]}},computed:{getChildrenUrl:function(){return this.childrenUrl?this.childrenUrl:this.url},slots:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var a,i=this.columns[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var l=a.value;l.scopedSlots&&l.scopedSlots.customRender&&e.push(l.scopedSlots.customRender)}}catch(o){n=!0,r=o}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e},tableAttrs:function(){return Object.assign(this.$attrs,this.tableProps)}},watch:{queryParams:{deep:!0,handler:function(){this.loadData()}}},created:function(){this.immediateRequest&&this.loadData()},methods:{loadData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.topValue,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.url;this.$emit("requestBefore",{first:n}),n&&(this.expandedRowKeys=[]);var a=Object.assign({},this.queryParams||{});return a[this.queryKey]=t,this.condition&&this.condition.length>0&&(a["condition"]=this.condition),Object(i["c"])(r,a).then((function(t){var r=[];if(t.result instanceof Array)r=t.result;else{if(!(t.result.records instanceof Array))throw"返回数据类型不识别";r=t.result.records}var a=r.map((function(t){if(!0===t.hasChildren){var n,r,a=!0,i=!1,o=void 0;try{for(var u,s=e.columns[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var d=u.value;if(r=d.dataIndex,r)break}}catch(h){i=!0,o=h}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}var c=(n={id:"".concat(t.id,"_loadChild")},l(n,r,"loading..."),l(n,"isLoading",!0),n);t.children=[c]}return t}));return n&&(e.dataSource=a),e.$emit("requestSuccess",{first:n,dataSource:a,res:t}),Promise.resolve(a)})).finally((function(){return e.$emit("requestFinally",{first:n})}))},handleExpand:function(e,t){e&&!0===t.children[0].isLoading&&this.loadData(t.id,!1,this.getChildrenUrl).then((function(e){0===e.length?t.children=null:t.children=e}))}}},u=o,s=n("2877"),d=Object(s["a"])(u,r,a,!1,null,"ba3bd2be",null);t["default"]=d.exports}}]);