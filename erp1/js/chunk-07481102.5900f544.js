(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07481102"],{"267bb":function(t,n,e){"use strict";e.r(n),e.d(n,"FinancialModalMixin",(function(){return u}));e("e2e0");var i=e("4ec3"),o=e("0fea"),a=e("ca00"),u={data:function(){return{action:"",supList:[],cusList:[],retailList:[],personList:[],accountList:[],spans:{labelCol1:{span:2},wrapperCol1:{span:22},labelCol1_5:{span:3},wrapperCol1_5:{span:21},labelCol2:{span:4},wrapperCol2:{span:20},labelCol3:{span:6},wrapperCol3:{span:18},labelCol6:{span:12},wrapperCol6:{span:12}}}},created:function(){},computed:{readOnly:function(){return"add"!==this.action&&"edit"!==this.action}},methods:{addInit:function(t){var n=this;Object(o["c"])("/sequence/buildNumber").then((function(e){e&&200===e.code&&n.form.setFieldsValue({billNo:t+e.data.defaultNumber})})),this.$nextTick((function(){n.form.setFieldsValue({billTime:Object(a["g"])(),totalPrice:0,discountMoney:0,changeAmount:0})})),this.$nextTick((function(){Object(i["ib"])({}).then((function(t){if(t&&200===t.code){var e=!0,i=!1,o=void 0;try{for(var a,u=t.data.accountList[Symbol.iterator]();!(e=(a=u.next()).done);e=!0){var c=a.value;c.isDefault&&n.form.setFieldsValue({accountId:c.id})}}catch(r){i=!0,o=r}finally{try{e||null==u.return||u.return()}finally{if(i)throw o}}}}))}))},initSupplier:function(){var t=this;Object(i["db"])({}).then((function(n){n&&(t.supList=n)}))},initCustomer:function(){var t=this;Object(i["bb"])({}).then((function(n){n&&(t.cusList=n)}))},initRetail:function(){var t=this;Object(i["cb"])({}).then((function(n){n&&(t.retailList=n)}))},initPerson:function(){var t=this;Object(i["qb"])({type:"财务员"}).then((function(n){n&&200===n.code&&(t.personList=n.data.personList)}))},initInOutItem:function(t){var n=this;Object(i["fb"])({type:t}).then((function(t){if(t){var e=!0,i=!1,o=void 0;try{for(var a,u=n.accountTable.columns[Symbol.iterator]();!(e=(a=u.next()).done);e=!0){var c=a.value;if("inOutItemId"==c.key){c.options=[];for(var r=0;r<t.length;r++){var l={};l.value=t[r].id+"",l.text=t[r].name,l.title=t[r].name,c.options.push(l)}}}}catch(s){i=!0,o=s}finally{try{e||null==u.return||u.return()}finally{if(i)throw o}}}}))},initAccount:function(){var t=this;Object(i["ib"])({}).then((function(n){n&&200===n.code&&(t.accountList=n.data.accountList)}))},initDetailAccount:function(){var t=this;Object(i["ib"])({}).then((function(n){if(n&&200===n.code){var e=n.data.accountList,i=!0,o=!1,a=void 0;try{for(var u,c=t.accountTable.columns[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var r=u.value;if("accountId"==r.key){r.options=[];for(var l=0;l<e.length;l++){var s={};s.value=e[l].id+"",s.text=e[l].name,s.title=e[l].name,r.options.push(s)}}}}catch(f){o=!0,a=f}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}}}))},onValueChange:function(t){var n=this,e=(t.type,t.row,t.column),i=(t.value,t.target);switch(e.key){case"eachAmount":i.recalcAllStatisticsColumns(),n.autoChangeAmount(i);break}},autoChangeAmount:function(t){var n=this,e=t.statisticsColumns.eachAmount-0,i=this.form.getFieldValue("discountMoney")-0;i||(i=0);var o=(e-i).toFixed(2);this.$nextTick((function(){n.form.setFieldsValue({totalPrice:e,changeAmount:o})}))},onKeyUpDiscountMoney:function(t){var n=this,e=t.target.value-0,i=this.form.getFieldValue("totalPrice")-0,o=(i-e).toFixed(2);this.$nextTick((function(){n.form.setFieldsValue({changeAmount:o})}))},debtBillListOk:function(t){t&&t.length>0&&this.requestSubTableDataEx(t,this.accountTable)},requestSubTableDataEx:function(t,n,e){var i=this;n.loading=!0;for(var o=[],a=0,u=0;u<t.length;u++){var c=t[u];c.billNumber=c.number,c.needDebt=(c.discountLastMoney+c.otherMoney-c.changeAmount).toFixed(2),c.eachAmount=(c.discountLastMoney+c.otherMoney-c.changeAmount-c.finishDebt).toFixed(2),0!=c.eachAmount&&(a+=c.eachAmount-0,o.push(c))}n.dataSource=o,this.$nextTick((function(){i.form.setFieldsValue({totalPrice:a,changeAmount:a})})),"function"===typeof e&&e(res),n.loading=!1}}}},e2e0:function(t,n,e){"use strict";function i(t){return i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}e.d(n,"a",(function(){return o})),e.d(n,"b",(function(){return a})),e.d(n,"c",(function(){return u})),e.d(n,"d",(function(){return c}));var o={normal:"normal",input:"input",inputNumber:"inputNumber",checkbox:"checkbox",select:"select",date:"date",datetime:"datetime",upload:"upload",file:"file",image:"image",popup:"popup",popupJsh:"popupJsh",list_multi:"list_multi",sel_search:"sel_search",radio:"radio",checkbox_meta:"checkbox_meta",input_pop:"input_pop",slot:"slot",hidden:"hidden"},a=Symbol();function u(t,n){return new Promise((function(e){(function i(){var o=t.$refs[n];o?e(o):setTimeout((function(){i()}),10)})()}))}function c(t,n){if(!t||"function"!==typeof t.validateFields)throw"form 参数需要的是一个form对象，而传入的却是".concat(i(t));var e={};return new Promise((function(n,e){t.validateFields((function(t,i){t?e({error:a}):n(i)}))})).then((function(t){return Object.assign(e,{formValue:t}),r(n)})).then((function(t){return Object.assign(e,{tablesValue:t}),Promise.resolve(e)})).catch((function(t){return Promise.reject(t)}))}function r(t,n){if(!(t instanceof Array))throw"'validateTables'函数的'cases'参数需要的是一个数组，而传入的却是".concat(i(t));return new Promise((function(e,i){var o=[],u=0;t&&0!=t.length||e(),function c(){var r=t[u];r.getAll(!0,n).then((function(n){o[u]=n,++u===t.length?e(o):c()}),(function(t){t===a&&i({error:a,index:u}),i(t)}))}()}))}}}]);